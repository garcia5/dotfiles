#!/bin/bash

status_output=$1
if [[ -z "$status_output" ]]; then
    exit 0
fi

fname="${status_output##* }"
status_cols="${status_output% *}"

if [[ "$status_cols" == 'M ' ]]; then
    # staged changes
    git diff --staged -- "$fname" | fzf-delta
elif [[ "$status_cols" == '??' ]]; then
    # new dir
    if [[ -d "$fname" ]]; then
        eza --color=always -T --level 2 "$fname"
    else
        # new file
        bat "$fname"
    fi
else
    git diff -- "$fname" | fzf-delta
fi
